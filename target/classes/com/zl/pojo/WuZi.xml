<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zl.dao.IWuZiDao" >
	<!-- 分页查询 -->
	<select id="findSplitByFy" parameterType="java.lang.Integer" resultType="com.zl.pojo.WuZi">
		select * from wuzi limit #{cp},5	
	</select>
	
	<select id="findCount" resultType="java.lang.Integer">
		select count(wuziid) from wuzi
	</select> 

	<select id="findById" resultType="com.zl.pojo.WuZi" parameterType="java.lang.Integer">
		select wuziid,guigeid,wuziname,wuzicount,price,changshangid from wuzi where wuziid=#{wuziid} 
	</select>
	<!-- 根据id修改 -->
	<update id="updatewuzi" parameterType="com.zl.pojo.WuZi">
		update wuzi
		<set>
			<if test="wuziname!=null"> wuziname=#{wuziname}, </if>
			<if test="price!=null"> price=#{price}, </if>
			<if test="wuzicount!=null"> wuzicount=#{wuzicount}, </if>			
			<if test="changshangid!=null">changshangid=#{changshangid}, </if>
		</set>
		 where wuziid=#{wuziid}
	</update>
	<!-- 多条件分页查询 -->
	<select id="findWuZiByFy" parameterType="com.zl.pojo.FenYe" resultMap="findSplit">
		select * from wuzi 
			<where>
				<if test="query!=null">
					<if test="query.qwuziname!=null and query.qwuziname!=''">
						and wuziname like '%${query.qwuziname}%'
					</if>
					<if test="query.qchangshangid!=null and query.qchangshangid!=''">
						and changshangid =#{query.qchangshangid}
					</if>
					<if test="query.lowprice!=null">
						and price>=#{query.lowprice}
					</if>
					<if test="query.highprice!=null">
						and price<![CDATA[<=]]>#{query.highprice}
					</if>		
				</if>
			</where>
		limit #{rowStart},5	
	</select>
	<!--查询记录总数  -->
	<select id="findRowsByQuery" parameterType="com.zl.pojo.Query" resultType="java.lang.Integer">
		select count(*) from wuzi
			<where>
				<if test="qwuziname!=null and qwuziname!=''">
						and wuziname like '%${qwuziname}%'
					</if>
					<if test="qchangshangid!=null and qchangshangid!=''">
						and changshangid =#{qchangshangid}
					</if>
					<if test="lowprice!=null">
						and price>=#{lowprice}
					</if>
					<if test="highprice!=null">
						and price<![CDATA[<=]]>#{highprice}
					</if>		
			</where>
	</select>
	<resultMap type="com.zl.pojo.WuZi" id="findSplit">
		<id column="wuziid" property="wuziid"/>
		<!-- 级联查询厂商 -->
		<association property="changshang" column="changshangid" javaType="com.zl.pojo.Changshang" select="com.zl.dao.IChangshangDao.findChangshangById"></association>
		
	</resultMap>
	<delete id="deleteAll" parameterType="int[]">
		delete from wuzi where wuziid in 
		<foreach collection="array" index="index" item="arr" open="(" separator="," close=")" >
			#{arr}
		</foreach>
	</delete> 
	
	<delete id="deletewuzi" parameterType="int[]">
		delete from wuzi where wuziid=#{wuziid} 
	</delete>
	
</mapper>